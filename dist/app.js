!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.GameEngine=e():t.GameEngine=e()}(this,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/dist",n(n.s=23)}([function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(e)}t.exports=n},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}},function(t,e,n){var r=n(14);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}},function(t,e,n){var r=n(15),i=n(8);t.exports=function(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?i(t):e}},function(t,e,n){"use strict";n.r(e),n.d(e,"ArcadePhysics",(function(){return _})),n.d(e,"Body",(function(){return J})),n.d(e,"Container",(function(){return j})),n.d(e,"DisplayObject",(function(){return x})),n.d(e,"EventEmitter",(function(){return b})),n.d(e,"Game",(function(){return Z})),n.d(e,"Keyboard",(function(){return W})),n.d(e,"Line",(function(){return et})),n.d(e,"Loader",(function(){return H})),n.d(e,"Mouse",(function(){return nt})),n.d(e,"Point",(function(){return it})),n.d(e,"Renderer",(function(){return $})),n.d(e,"Scene",(function(){return A})),n.d(e,"Sprite",(function(){return z})),n.d(e,"Util",(function(){return M}));var r=n(1),i=n.n(r),o=n(2),a=n.n(o),s=n(8),c=n.n(s),u=n(3),l=n.n(u),f=n(4),h=n.n(f),y=n(0),d=n.n(y),v=n(6),p=n.n(v);function m(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return g(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var b=function(){function t(){i()(this,t),this.handlers={}}return a()(t,[{key:"on",value:function(){this.addEventListener.apply(this,arguments)}},{key:"off",value:function(){this.removeEventListener.apply(this,arguments)}},{key:"addEventListener",value:function(t,e){this.handlers.hasOwnProperty(t)||(this.handlers[t]=[]),this.handlers[t].push(e)}},{key:"removeEventListener",value:function(){}},{key:"emit",value:function(t){if(this.handlers.hasOwnProperty(t)){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i,o=m(this.handlers[t]);try{for(o.s();!(i=o.n()).done;){var a=i.value;a.apply(void 0,n)}}catch(t){o.e(t)}finally{o.f()}}}}]),t}();function w(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var x=function(t){l()(n,t);var e=w(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),(t=e.call(this)).uid=M.generateUid(),t.x=r.x||0,t.y=r.y||0,t.width=r.width||0,t.height=r.height||0,t.rotation=r.rotation||0,t.anchorX=r.anchorX||0,t.anchorY=r.anchorY||0,t.scale=r.scale||1,t.scaleX=r.scaleX||1,t.scaleY=r.scaleY||1,t.parent=null,t.visible=!0,void 0!==r.scale&&t.setScale(r.scale),t}return a()(n,[{key:"setScale",value:function(t){this.scaleX=t,this.scaleY=t}},{key:"setParent",value:function(t){this.parent&&this.parent.remove&&this.parent.remove(this),t&&t.add&&t.add(this),this.parent=t}},{key:"draw",value:function(t){this.visible&&t()}},{key:"scene",get:function(){return M.getScene(this)}},{key:"game",get:function(){return this.scene.parent}},{key:"absoluteX",get:function(){return this.x-this.anchorX*this.width*this.scaleX},set:function(t){return this.x=t+this.anchorX*this.width*this.scaleX,t}},{key:"absoluteY",get:function(){return this.y-this.anchorY*this.height*this.scaleY},set:function(t){return this.y=t+this.anchorY*this.height*this.scaleY,t}},{key:"centerX",get:function(){return this.absoluteX+this.width/2*this.scaleX},set:function(t){return this.absoluteX=t-this.width/2}},{key:"centerY",get:function(){return this.absoluteY+this.height/2*this.scaleY},set:function(t){return this.absoluteY=t-this.height/2}}]),n}(b);function S(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return O(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function k(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var j=function(t){l()(n,t);var e=k(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),(t=e.call(this,r)).displayObjects=[],delete t.width,delete t.height,t}return a()(n,[{key:"add",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];this.displayObjects.includes(o)||(this.displayObjects.push(o),o.setParent(this))}}},{key:"tick",value:function(t){var e,n=S(this.displayObjects);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.tick&&r.tick(t)}}catch(t){n.e(t)}finally{n.f()}}},{key:"remove",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];if(this.displayObjects.includes(o)){var a=this.displayObjects.indexOf(o);this.displayObjects.splice(a,1),o.setParent(null)}}}},{key:"draw",value:function(t,e){var r=this;p()(d()(n.prototype),"draw",this).call(this,(function(){e.save(),e.translate(r.x,r.y),e.rotate(-r.rotation),e.scale(r.scaleX,r.scaleY);var n,i=S(r.displayObjects);try{for(i.s();!(n=i.n()).done;){n.value.draw(t,e)}}catch(t){i.e(t)}finally{i.f()}e.restore()}))}}]),n}(x);function P(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var A=function(t){l()(n,t);var e=P(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),(t=e.call(this)).autoStart=r.autoStart||!1,t.name=r.name||"",t.status="waiting",t.stage=t.displayObjects,r.loading&&(t.loading=r.loading.bind(c()(t))),r.init&&(t.init=r.init.bind(c()(t))),r.update&&(t.update=r.update.bind(c()(t))),r.beforeDestroy&&(t.beforeDestroy=r.beforeDestroy.bind(c()(t))),t}return a()(n,[{key:"loading",value:function(){}},{key:"init",value:function(){}},{key:"update",value:function(){}},{key:"beforeDestroy",value:function(){}}]),n}(j),R={},D=[],E={delay:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return R[t]?!(R[t]+e>Date.now())&&(R[t]=Date.now(),!0):(R[t]=Date.now(),!0)},generateUid:function(){for(var t=C();D.includes(t);)t=C();return t},isInside:function(t,e){return e.x<=t.x&&t.x<=e.x+e.width&&e.y<=t.y&&t.y<=e.y+e.height},removeElements:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];if(t.includes(a)){var s=t.indexOf(a);t.splice(s,1)}}},getScene:function(t){return!t||t instanceof A?t:E.getScene(t.parent)},tween:function(t){var e=t.target,n=t.duration,r=t.processer;if(!e)throw new Error("Tween without target object.");var i=Date.now(),o={},a=!1,s=function(){var t=Math.min((Date.now()-i)/n,1);r(e,t,o),t>=1&&(a=!0,o=null,e=null,r=null,clearInterval(c))};s();var c=setInterval(s);return function(){a||(a=!0,o=null,e=null,r=null,s=null,clearInterval(c))}},getRandomFrom:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e[Math.floor(Math.random()*e.length)]}},I="qwertyuiopasdfghjklzxcvbnm1234567890";function U(){return I[Math.floor(Math.random()*I.length)]}function C(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e="";e.length<t;)e+=U();return e}var M=E;function T(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return L(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function L(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var _=function(){function t(){i()(this,t),this.objects=new Set}return a()(t,[{key:"add",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];this.objects.add(o)}}},{key:"remove",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];this.objects.delete(o)}}},{key:"processing",value:function(){for(var t=Array.from(this.objects),e=0;e<t.length-1;e++)for(var n=t[e],r=n.bodyRect,i=n.tops,o=n.velocity.x,a=n.velocity.y,s=e+1;s<t.length;s++){var c=t[s],u=c.bodyRect,l=c.tops,f=c.velocity.x,h=c.velocity.y;if(!n.static||!c.static){var y,d=!1,v=T(i);try{for(v.s();!(y=v.n()).done;){var p=y.value;if(d=M.isInside({x:p[0]+o,y:p[1]+a},{x:u.x+f,y:u.y+h,width:u.width,height:u.height}))break}}catch(t){v.e(t)}finally{v.f()}if(!1===d){var m,g=T(l);try{for(g.s();!(m=g.n()).done;){var b=m.value;if(d=M.isInside({x:b[0]+f,y:b[1]+h},{x:r.x+o,y:r.y+a,width:r.width,height:r.height}))break}}catch(t){g.e(t)}finally{g.f()}}d&&(n.emit("collision",c,n),c.emit("collision",n,c))}}}}]),t}(),B=n(7),X=n.n(B);function Y(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return F(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return F(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function F(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function K(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var z=function(t){l()(n,t);var e=K(n);function n(t){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i()(this,n),r=e.call(this,o);var a=o.frame||{},s=o.velocity||{};return r.texture=t,r.keysDefault=o.keysDefault||[],r.frames=[],r.frameNumber=0,r.frameDelay=0,r.animations={},r.animation="",r.animationPaused=!1,r.velocity={x:s.x||0,y:s.y||0},r.frame={x:a.x||0,y:a.y||0,width:a.width||t?t.width:0,height:a.height||t?t.height:0},void 0===o.width&&(r.width=r.frame.width),void 0===o.height&&(r.height=r.frame.height),r}return a()(n,[{key:"setFramesCollection",value:function(t){this.frames=t}},{key:"setAnimationsCollection",value:function(t){this.animations=t}},{key:"startAnimation",value:function(t){if(!this.animations.hasOwnProperty(t))return!1;var e=this.animations[t],n=e.duration,r=void 0===n?1/0:n,i=e.keys;this.animation=t,this.frameDelay=r/i.length,this.setFrameByKeys.apply(this,X()(i[0]))}},{key:"pauseAnimation",value:function(){this.animationPaused=!0}},{key:"resumeAnimation",value:function(){this.animationPaused=!1}},{key:"setFrameByKeys",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=this.getFrameByKeys.apply(this,e.concat(X()(this.keysDefault)));if(!r)return!1;this.frame.x=r.x,this.frame.y=r.y,this.frame.width=r.width,this.frame.height=r.height,this.width=this.frame.width,this.height=this.frame.height}},{key:"getFrameByKeys",value:function(){for(var t=!1,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i,o=Y(this.frames);try{for(o.s();!(i=o.n()).done;){var a=i.value;t=!0;var s,c=Y(n);try{for(c.s();!(s=c.n()).done;){var u=s.value;if(!a.keys.includes(u)){t=!1;break}}}catch(t){c.e(t)}finally{c.f()}if(t)return JSON.parse(JSON.stringify(a))}}catch(t){o.e(t)}finally{o.f()}}},{key:"tick",value:function(t){if(!this.animationPaused&&this.animation&&M.delay(this.animation+this.uid,this.frameDelay)){var e=this.animations[this.animation].keys;this.frameNumber=(this.frameNumber+1)%e.length,this.setFrameByKeys.apply(this,X()(e[this.frameNumber])),this.emit("frameChange",this)}this.x+=this.velocity.x,this.y+=this.velocity.y}},{key:"draw",value:function(t,e){var r=this;p()(d()(n.prototype),"draw",this).call(this,(function(){e.save(),e.translate(r.x,r.y),e.rotate(-r.rotation),r.texture&&e.drawImage(r.texture,r.frame.x,r.frame.y,r.frame.width,r.frame.height,r.absoluteX-r.x,r.absoluteY-r.y,r.width*r.scaleX,r.height*r.scaleY),e.restore()}))}}]),n}(x);function N(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var J=function(t){l()(n,t);var e=N(n);function n(t){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i()(this,n),r=e.call(this,t,o);var a=o.body||{};return r.debug=o.debug||!1,r.static=o.static||!1,r.body={},r.body.x=a.x||0,r.body.y=a.y||0,r.body.width=a.width||1,r.body.height=a.height||1,r}return a()(n,[{key:"isInside",value:function(t,e){return M.isInside({x:t,y:e},this.bodyRect)}},{key:"draw",value:function(t,e){if(this.visible){if(e.save(),e.translate(this.x,this.y),e.rotate(-this.rotation),e.drawImage(this.texture,this.frame.x,this.frame.y,this.frame.width,this.frame.height,this.absoluteX-this.x,this.absoluteY-this.y,this.width*this.scaleX,this.height*this.scaleY),this.debug){var n=this.bodyRect,r=n.x,i=n.y,o=n.width,a=n.height;e.fillStyle="rgba(255, 0, 0, 0.2)",e.beginPath(),e.rect(r-this.x,i-this.y,o,a),e.fill(),e.fillStyle="rgb(0, 255, 0)",e.beginPath(),e.arc(0,0,3,0,2*Math.PI),e.fill()}e.restore()}}},{key:"bodyRect",get:function(){return{x:this.absoluteX+this.width*this.scaleX*this.body.x,y:this.absoluteY+this.height*this.scaleY*this.body.y,width:this.width*this.scaleX*this.body.width,height:this.height*this.scaleY*this.body.height}}},{key:"tops",get:function(){var t=this.bodyRect,e=t.x,n=t.y,r=t.width,i=t.height;return[[e,n],[e+r,n],[e,n+i],[e+r,n+i]]}}]),n}(z),$=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i()(this,t),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.background=e.background||"black",this.canvas.width=e.width||50,this.canvas.height=e.height||50}return a()(t,[{key:"draw",value:function(t){t(this.canvas,this.context)}},{key:"clear",value:function(){this.context.fillStyle=this.background,this.context.beginPath(),this.context.rect(0,0,this.canvas.width,this.canvas.height),this.context.fill()}}]),t}();function G(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return q(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function q(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var H=function(){function t(){i()(this,t),this.loadOrder={images:[],jsons:[],sounds:[]},this.resources={images:{},jsons:{},sounds:{}}}return a()(t,[{key:"addImage",value:function(t,e){this.loadOrder.images.push({name:t,src:e})}},{key:"addJson",value:function(t,e){this.loadOrder.jsons.push({name:t,address:e})}},{key:"addSound",value:function(t,e){this.loadOrder.sounds.push({name:t,src:e})}},{key:"getImage",value:function(t){return this.resources.images[t]}},{key:"getJson",value:function(t){return this.resources.jsons[t]}},{key:"getSound",value:function(t){return this.resources.sounds[t]}},{key:"load",value:function(e){var n,r=this,i=[],o=G(this.loadOrder.images);try{var a=function(){var e=n.value,o=e.name,a=e.src,s=t.loadImage(a).then((function(t){if(r.resources.images[o]=t,r.loadOrder.images.includes(e)){var n=r.loadOrder.images.indexOf(e);r.loadOrder.images.splice(n,1)}}));i.push(s)};for(o.s();!(n=o.n()).done;)a()}catch(t){o.e(t)}finally{o.f()}var s,c=G(this.loadOrder.jsons);try{var u=function(){var e=s.value,n=e.name,o=e.address,a=t.loadJson(o).then((function(t){if(r.resources.jsons[n]=t,r.loadOrder.jsons.includes(e)){var i=r.loadOrder.jsons.indexOf(e);r.loadOrder.jsons.splice(i,1)}}));i.push(a)};for(c.s();!(s=c.n()).done;)u()}catch(t){c.e(t)}finally{c.f()}var l,f=G(this.loadOrder.sounds);try{var h=function(){var e=l.value,n=e.name,o=e.src,a=t.loadSound(o).then((function(t){if(r.resources.sounds[n]=t,r.loadOrder.sounds.includes(e)){var i=r.loadOrder.sounds.indexOf(e);r.loadOrder.sounds.splice(i,1)}}));i.push(a)};for(f.s();!(l=f.n()).done;)h()}catch(t){f.e(t)}finally{f.f()}Promise.all(i).then(e)}}],[{key:"loadImage",value:function(t){return new Promise((function(e,n){try{var r=new Image;r.onload=function(){return e(r)},r.src=t}catch(t){n(t)}}))}},{key:"loadJson",value:function(t){return new Promise((function(e,n){fetch(t).then((function(t){return t.json()})).then((function(t){return e(t)})).catch((function(t){return n(t)}))}))}},{key:"loadSound",value:function(t){return new Promise((function(e,n){try{(new Audio).src=t}catch(t){n(t)}}))}}]),t}(),W=function t(){i()(this,t);var e=this;this.arrowUp=!1,this.arrowDown=!1,this.arrowLeft=!1,this.arrowRight=!1,this.space=!1,document.body.addEventListener("keydown",(function(t){switch(t.code){case"KeyW":e.arrowUp=!0;break;case"KeyS":e.arrowDown=!0;break;case"KeyD":e.arrowRight=!0;break;case"KeyA":e.arrowLeft=!0;break;case"Space":e.space=!0}})),document.body.addEventListener("keyup",(function(t){switch(t.code){case"KeyW":e.arrowUp=!1;break;case"KeyS":e.arrowDown=!1;break;case"KeyD":e.arrowRight=!1;break;case"KeyA":e.arrowLeft=!1;break;case"Space":e.space=!1}}))};function Q(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return V(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return V(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function V(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Z=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i()(this,t),this.renderer=new $(n),this.loader=new H,this.scenesCollection=new j,this.keyboard=new W,n.scenes&&this.addScene.apply(this,X()(n.scenes)),n.el&&n.el.appendChild&&n.el.appendChild(this.renderer.canvas);var r,o=this.scenes.filter((function(t){return t.autoStart})),a=Q(o);try{for(a.s();!(r=a.n()).done;){var s=r.value;s.status="loading",s.loading(this.loader)}}catch(t){a.e(t)}finally{a.f()}this.loader.load((function(){var t,e=Q(o);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.status="init",n.init()}}catch(t){e.e(t)}finally{e.f()}var r,i=Q(o);try{for(i.s();!(r=i.n()).done;){r.value.status="started"}}catch(t){i.e(t)}finally{i.f()}})),requestAnimationFrame((function(t){return e.tick(t)}))}return a()(t,[{key:"addScene",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];(t=this.scenesCollection).add.apply(t,n);for(var i=0,o=n;i<o.length;i++){var a=o[i];a.parent=this}}},{key:"tick",value:function(t){var e,n=this,r=this.scenes.filter((function(t){return"started"===t.status})),i=Q(r);try{for(i.s();!(e=i.n()).done;){e.value.update(t)}}catch(t){i.e(t)}finally{i.f()}var o,a=Q(r);try{for(a.s();!(o=a.n()).done;){o.value.tick(t)}}catch(t){a.e(t)}finally{a.f()}this.renderer.clear();var s,c=Q(r);try{for(c.s();!(s=c.n()).done;){s.value.draw(this.renderer.canvas,this.renderer.context)}}catch(t){c.e(t)}finally{c.f()}requestAnimationFrame((function(t){return n.tick(t)}))}},{key:"getScene",value:function(t){if(t instanceof A&&this.scenes.includes(t))return t;if("string"==typeof t){var e,n=Q(this.scenes);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(r.name===t)return r}}catch(t){n.e(t)}finally{n.f()}}}},{key:"startScene",value:function(t){var e=this.getScene(t);return!!e&&(e.status="loading",e.loading(this.loader),this.loader.load((function(){e.status="init",e.init(),e.status="started"})),!0)}},{key:"finishScene",value:function(t){var e=this.getScene(t);if(!e)return!1;e.status="finished",this.scenesCollection.remove(e),e.beforeDestroy()}},{key:"scenes",get:function(){return this.scenesCollection.displayObjects}}]),t}();function tt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var et=function(t){l()(n,t);var e=tt(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),(t=e.call(this,r)).color=r.color||"red",t.x1=r.x1||0,t.y1=r.y1||0,t.x2=r.x2||0,t.y2=r.y2||0,t}return a()(n,[{key:"draw",value:function(t,e){var r=this;p()(d()(n.prototype),"draw",this).call(this,(function(){e.strokeStyle=r.color,e.lineWidth=1,e.beginPath(),e.moveTo(r.x1,r.y1),e.lineTo(r.x2,r.y2),e.stroke()}))}}]),n}(x),nt=function t(){i()(this,t)};function rt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d()(t);if(e){var i=d()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var it=function(t){l()(n,t);var e=rt(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(this,n),(t=e.call(this,r)).color=r.color||"red",t}return a()(n,[{key:"draw",value:function(t,e){var r=this;p()(d()(n.prototype),"draw",this).call(this,(function(){e.fillStyle=r.color,e.beginPath(),e.arc(r.x,r.y,3,0,2*Math.PI),e.fill()}))}}]),n}(x);Object.assign(Z,{ArcadePhysics:_,Body:J,Container:j,DisplayObject:x,EventEmitter:b,Game:Z,Keyboard:W,Line:et,Loader:H,Mouse:nt,Point:it,Renderer:$,Scene:A,Sprite:z,Util:M});e.default=Z},function(t,e,n){var r=n(16);function i(e,n,o){return"undefined"!=typeof Reflect&&Reflect.get?t.exports=i=Reflect.get:t.exports=i=function(t,e,n){var i=r(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}},i(e,n,o||e)}t.exports=i},function(t,e,n){var r=n(17),i=n(18),o=n(13),a=n(19);t.exports=function(t){return r(t)||i(t)||o(t)||a()}},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e,n){var r=n(20),i=n(21),o=n(13),a=n(22);t.exports=function(t,e){return r(t)||i(t,e)||o(t,e)||a()}},function(t){t.exports=JSON.parse('{"a":false}')},function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}},function(t,e,n){var r=n(12);t.exports=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}},function(t,e){function n(e,r){return t.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(e,r)}t.exports=n},function(t,e){function n(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=n=function(t){return typeof t}:t.exports=n=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(e)}t.exports=n},function(t,e,n){var r=n(0);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=r(t)););return t}},function(t,e,n){var r=n(12);t.exports=function(t){if(Array.isArray(t))return r(t)}},function(t,e){t.exports=function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(t,e){t.exports=function(t){if(Array.isArray(t))return t}},function(t,e){t.exports=function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(t,e,n){"use strict";n.r(e);var r=n(5),i=n(9),o=n.n(i),a=n(1),s=n.n(a),c=n(2),u=n.n(c),l=n(3),f=n.n(l),h=n(4),y=n.n(h),d=n(0),v=n.n(d);function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){o()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function g(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=v()(t);if(e){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}var b=function(t){f()(n,t);var e=g(n);function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s()(this,n),e.call(this,m({name:"introScene"},t))}return u()(n,[{key:"loading",value:function(t){t.addImage("intro","static/intro.png")}},{key:"init",value:function(){var t=this.parent.loader;this.image=new r.Sprite(t.getImage("intro"),{x:0,y:this.parent.renderer.canvas.height,width:this.parent.renderer.canvas.width,height:this.parent.renderer.canvas.height}),this.add(this.image),this.imageTweenStopper=r.Util.tween({target:this.image,duration:3500,processer:function(t,e,n){0===e&&(n.y=t.y),t.y=n.y*(1-e)}})}},{key:"update",value:function(t){this.parent.keyboard.space&&r.Util.delay("introSpace",1500)&&(this.imageTweenStopper&&0!==this.image.y?(this.imageTweenStopper(),delete this.imageTweenStopper,this.image.y=0):(this.parent.startScene("party"),this.parent.finishScene(this)))}}]),n}(r.Scene),w=n(10),x=n.n(w),S=n(7),O=n.n(S);function k(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=v()(t);if(e){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}var j=function(t){f()(n,t);var e=k(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s()(this,n);var i=Object.assign({scale:2,anchorX:.5,anchorY:.5},r);return(t=e.call(this,n.texture,i)).tank=null,t.toDestroy=!1,t.setFramesCollection(n.atlas.frames),t.setAnimationsCollection(n.atlas.actions),t.on("collision",(function(e,n){e!==t.tank&&(e.isEnemy&&n.isEnemy||(t.toDestroy=!0))})),t}return u()(n,[{key:"destroy",value:function(){r.Util.removeElements(this.tank.bullets,this),delete this.tank;var t=this.scene;t.arcadePhysics.remove(this),t.remove(this)}}]),n}(r.Body);j.texture=null,j.atlas=null,j.NORMAL_SPEED=5;var P=n(11);function A(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=v()(t);if(e){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}var R=function(t){f()(n,t);var e=A(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s()(this,n);var i=Object.assign({scale:3.5,keysDefault:["yellow","type1"],debug:P.a},r);return(t=e.call(this,n.texture,i)).bullets=[],t.setFramesCollection(n.atlas.frames),t.setAnimationsCollection(n.atlas.actions),t.startAnimation("moveUp"),t.on("collision",(function(e,n){return t.collisionHandler(e,n)})),t}return u()(n,[{key:"collisionHandler",value:function(t,e){if(t instanceof j){if(this.bullets.includes(t))return;this.scene.arcadePhysics.remove(this),this.scene.remove(this)}this.velocity.x=0,this.velocity.y=0}},{key:"fire",value:function(){var t=new j({debug:P.a,x:this.centerX,y:this.centerY});return this.bullets.push(t),t.tank=this,"moveUp"===this.animation?(t.velocity.y=-j.NORMAL_SPEED,t.setFrameByKeys("bullet","up")):"moveDown"===this.animation?(t.velocity.y=j.NORMAL_SPEED,t.setFrameByKeys("bullet","down")):"moveLeft"===this.animation?(t.velocity.x=-j.NORMAL_SPEED,t.setFrameByKeys("bullet","left")):"moveRight"===this.animation&&(t.velocity.x=j.NORMAL_SPEED,t.setFrameByKeys("bullet","right")),this.scene.add(t),this.scene.arcadePhysics.add(t),t}},{key:"movementUpdate",value:function(t){var e=this,n=function(n){return e.setDirect(n,t.space)};t.arrowUp?n("up"):t.arrowLeft?n("left"):t.arrowRight?n("right"):t.arrowDown?n("down"):n(null)}},{key:"setDirect",value:function(t,e){this.velocity.x=0,this.velocity.y=0,this.animationPaused&&this.resumeAnimation(),"left"===t?(this.velocity.x=-n.NORMAL_SPEED,"moveLeft"!==this.animation&&this.startAnimation("moveLeft")):"right"===t?(this.velocity.x=n.NORMAL_SPEED,"moveRight"!==this.animation&&this.startAnimation("moveRight")):"down"===t?(this.velocity.y=n.NORMAL_SPEED,"moveDown"!==this.animation&&this.startAnimation("moveDown")):"up"===t?(this.velocity.y=-n.NORMAL_SPEED,"moveUp"!==this.animation&&this.startAnimation("moveUp")):this.pauseAnimation(),e&&r.Util.delay("tank"+this.uid,n.BULLET_TIMEOUT)&&this.fire()}}]),n}(r.Body);function D(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function E(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?D(Object(n),!0).forEach((function(e){o()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function I(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=v()(t);if(e){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}R.texture=null,R.atlas=null,R.NORMAL_SPEED=2,R.BULLET_TIMEOUT=1e3;var U=function(t){f()(n,t);var e=I(n);function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s()(this,n),e.call(this,E({keysDefault:["gray","type1"]},t))}return u()(n,[{key:"collisionHandler",value:function(t,e){if(t instanceof j){if(this.bullets.includes(t))return;if(t.isEnemy)return;this.scene.arcadePhysics.remove(this),this.scene.remove(this)}this.velocity.x=0,this.velocity.y=0,this.nextDirect=r.Util.getRandomFrom("up","left","right","down")}}]),n}(R);function C(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return M(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function M(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function T(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=v()(t);if(e){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}var L=function(t){f()(n,t);var e=T(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s()(this,n),(t=e.call(this,{})).map=i.map||[[]],t.size=i.fieldSize||20;var o=t.getCoordinats("eagle",!0),a=x()(o,2),c=a[0],u=a[1];t.eagle=new r.Body(n.texture,{debug:P.a,static:!0,x:c*t.size,y:u*t.size}),t.eagle.setFramesCollection(n.atlas.frames),t.eagle.setFrameByKeys("eagle"),t.eagle.width=t.size,t.eagle.height=t.size,t.add(t.eagle);var l,f=C(t.getCoordinats("brick"));try{for(f.s();!(l=f.n()).done;)for(var h=x()(l.value,2),y=h[0],d=h[1],v=0;v<=1;v++)for(var p=function(e){var i=new r.Body(n.texture,{debug:P.a,static:!0,anchorX:v,anchorY:e});i.setFramesCollection(n.atlas.frames),i.setFrameByKeys("wall","brick"),i.width=t.size/2,i.height=t.size/2,i.x=y*t.size+t.size/2,i.y=d*t.size+t.size/2,i.isBrick=!0,t.add(i),i.on("collision",(function(e){e instanceof j&&(t.remove(i),t.scene.arcadePhysics.remove(i))}))},m=0;m<=1;m++)p(m)}catch(t){f.e(t)}finally{f.f()}return t}return u()(n,[{key:"getCoordinats",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],r=0;r<this.map.length;r++)for(var i=0;i<this.map[r].length;i++)if(this.map[r][i]===t){if(e)return[i,r];n.push([i,r])}return n}}]),n}(r.Container);function _(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return B(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return B(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function B(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function X(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?X(Object(n),!0).forEach((function(e){o()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function F(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=v()(t);if(e){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}L.texture=null,L.atlas=null;var K=function(t){f()(n,t);var e=F(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s()(this,n),(t=e.call(this,Y({name:"party"},r))).enemies=new Set,t}return u()(n,[{key:"loading",value:function(t){t.addImage("spriteSheet","static/Battle City Sprites.png"),t.addJson("atlas","static/atlas.json"),t.addJson("map","static/map1.json"),t.addJson("party","static/party.json")}},{key:"init",value:function(){var t,e=this,n=this.parent,i=n.loader,o=n.renderer.canvas,a=o.width,s=o.height;j.texture=L.texture=R.texture=i.getImage("spriteSheet"),j.atlas=L.atlas=R.atlas=i.getJson("atlas"),this.partyData=i.getJson("party"),this.arcadePhysics=new r.ArcadePhysics,this.arcadePhysics.add(new r.Body(null,{static:!0,x:-10,y:-10,width:a+20,height:9})),this.arcadePhysics.add(new r.Body(null,{static:!0,x:-10,y:s,width:a+20,height:9})),this.arcadePhysics.add(new r.Body(null,{static:!0,x:-10,y:-10,width:9,height:s+20})),this.arcadePhysics.add(new r.Body(null,{static:!0,x:a,y:-10,width:9,height:s+20})),this.topology=new L(i.getJson("map")),this.add(this.topology),(t=this.arcadePhysics).add.apply(t,O()(this.topology.displayObjects));var c=this.topology.getCoordinats("tank1",!0),u=x()(c,2),l=u[0],f=u[1];this.mainTank=new R({x:l*this.topology.size,y:f*this.topology.size}),this.add(this.mainTank),this.arcadePhysics.add(this.mainTank),this.topology.eagle&&this.topology.eagle.on("collision",(function(t){t instanceof j&&(e.game.startScene("resultScene"),e.game.finishScene(e))}))}},{key:"update",value:function(){var t=this.parent.keyboard;this.mainTank.movementUpdate(t);var e,n=_(this.enemies);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(this.displayObjects.includes(i)){if(i.nextDirect&&(i.setDirect(i.nextDirect),i.nextDirect=null),r.Util.delay(i.uid+"fired",R.BULLET_TIMEOUT))i.fire().isEnemy=!0}else this.enemies.delete(i)}}catch(t){n.e(t)}finally{n.f()}if(this.arcadePhysics.processing(),this.enemies.size<this.partyData.enemy.simultaneously&&r.Util.delay(this.uid+"enemyGeneration",this.partyData.enemy.spawnDelay)){var o=r.Util.getRandomFrom.apply(r.Util,O()(this.topology.getCoordinats("enemy"))),a=x()(o,2),s=a[0],c=a[1],u=new U({x:s*this.topology.size,y:c*this.topology.size});u.isEnemy=!0,this.enemies.add(u),this.add(u),this.arcadePhysics.add(u),u.setDirect("down")}var l,f=_(this.enemies);try{for(f.s();!(l=f.n()).done;)l.value}catch(t){f.e(t)}finally{f.f()}var h,y=_(this.arcadePhysics.objects);try{for(y.s();!(h=y.n()).done;){var d=h.value;d instanceof j&&d.toDestroy&&d.destroy()}}catch(t){y.e(t)}finally{y.f()}}}]),n}(r.Scene);e.default=new r.Game({el:document.body,width:650,height:650,background:"black",scenes:[new b({autoStart:!1}),new K({autoStart:!0})]})}])}));